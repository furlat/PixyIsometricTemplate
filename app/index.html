<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pixy Isometric Template</title>
    <link rel="stylesheet" href="/src/styles/main.css" />
  </head>
  <body>
    <canvas id="gameCanvas"></canvas>
    
    <!-- UI Control Bar -->
    <div id="ui-control-bar" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-base-100/95 backdrop-blur-md border border-base-300 rounded-full shadow-lg z-50 px-4 py-2">
      <div class="flex items-center gap-3">
        <span class="text-sm font-semibold text-primary">UI Controls</span>
        <div class="divider divider-horizontal mx-0"></div>
        <button id="toggle-store-panel" class="btn btn-sm btn-primary rounded-full">
          <span class="button-text">Store</span>
        </button>
        <button id="toggle-geometry-panel" class="btn btn-sm btn-secondary rounded-full">
          <span class="button-text">Geometry</span>
        </button>
      </div>
    </div>
    
    <!-- Store Panel (formerly UI Panel) -->
    <div id="store-panel" class="fixed top-4 right-4 w-80 max-h-[calc(100vh-2rem)] bg-base-100/95 backdrop-blur-md border border-base-300 rounded-xl shadow-2xl z-50 overflow-hidden animate-fade-in">
      <!-- Header -->
      <div class="bg-base-200/50 border-b border-base-300 p-4">
        <h2 class="text-lg font-bold text-primary flex items-center gap-2">
          <span class="text-info">📊</span>
          Store Panel
        </h2>
      </div>
      
      <!-- Scrollable Content -->
      <div class="max-h-[calc(100vh-8rem)] overflow-y-auto custom-scrollbar p-2">
        
        <!-- System Status -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-info flex items-center gap-2">
              <span class="text-xs">▸</span>
              System Status
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Initialized:</span>
                <span id="game-initialized" class="font-bold font-mono status-inactive">false</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Loading:</span>
                <span id="game-loading" class="font-bold font-mono status-active">true</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Scene:</span>
                <span id="game-scene" class="font-bold font-mono status-system">menu</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Camera & Canvas -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-warning flex items-center gap-2">
              <span class="text-xs">▸</span>
              Camera & Canvas
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Camera Position:</span>
                <span id="camera-position" class="font-bold font-mono status-camera">0, 0</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Pixeloid Scale:</span>
                <span id="pixeloid-scale" class="font-bold font-mono text-primary">10</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Top-Left Corner:</span>
                <span id="top-left-corner" class="font-bold font-mono status-camera">0, 0</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Bottom-Right Corner:</span>
                <span id="bottom-right-corner" class="font-bold font-mono status-camera">0, 0</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Window & Mouse -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-accent flex items-center gap-2">
              <span class="text-xs">▸</span>
              Window & Mouse
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Window Size:</span>
                <span id="window-size" class="font-bold font-mono text-info">0 x 0</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Mouse Position:</span>
                <span id="mouse-position" class="font-bold font-mono status-mouse">0, 0</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Mouse Pixeloid:</span>
                <span id="mouse-pixeloid-position" class="font-bold font-mono status-mouse">0.00, 0.00</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Input State -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-secondary flex items-center gap-2">
              <span class="text-xs">▸</span>
              Input State
            </h3>
            <div class="grid grid-cols-2 gap-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">W:</span>
                <span id="key-w" class="font-bold font-mono status-inactive">Released</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">A:</span>
                <span id="key-a" class="font-bold font-mono status-inactive">Released</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">S:</span>
                <span id="key-s" class="font-bold font-mono status-inactive">Released</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">D:</span>
                <span id="key-d" class="font-bold font-mono status-inactive">Released</span>
              </div>
              <div class="flex justify-between items-center text-xs col-span-2">
                <span class="text-base-content/70">Space:</span>
                <span id="key-space" class="font-bold font-mono status-inactive">Released</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Geometry Debug (Phase 1: Multi-Layer System) -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-success flex items-center gap-2">
              <span class="text-xs">▸</span>
              Geometry Debug
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Drawing Mode:</span>
                <span id="drawing-mode" class="font-bold font-mono text-success">none</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Objects Count:</span>
                <span id="objects-count" class="font-bold font-mono text-primary">0</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Selected Object:</span>
                <span id="selected-object" class="font-bold font-mono text-info">none</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Active Raycasts:</span>
                <span id="active-raycasts" class="font-bold font-mono text-warning">0</span>
              </div>
            </div>
            
            <!-- Layer Visibility -->
            <div class="divider my-2 text-xs text-base-content/50">Layer Visibility</div>
            <div class="grid grid-cols-3 gap-2">
              <div class="flex flex-col items-center text-xs">
                <span class="text-base-content/70 mb-1">Grid</span>
                <span id="layer-grid" class="font-bold font-mono status-active">ON</span>
              </div>
              <div class="flex flex-col items-center text-xs">
                <span class="text-base-content/70 mb-1">Geometry</span>
                <span id="layer-geometry" class="font-bold font-mono status-active">ON</span>
              </div>
              <div class="flex flex-col items-center text-xs">
                <span class="text-base-content/70 mb-1">Raycast</span>
                <span id="layer-raycast" class="font-bold font-mono status-active">ON</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Controls -->
        <div class="alert alert-info bg-info/10 border-info/20">
          <div class="w-full">
            <h4 class="font-bold text-sm text-info mb-2 flex items-center gap-2">
              <span>⌘</span>
              Controls
            </h4>
            <div class="space-y-1 text-xs text-base-content/80">
              <div class="flex items-center gap-2">
                <kbd class="kbd kbd-xs bg-base-300">W</kbd>
                <kbd class="kbd kbd-xs bg-base-300">A</kbd>
                <kbd class="kbd kbd-xs bg-base-300">S</kbd>
                <kbd class="kbd kbd-xs bg-base-300">D</kbd>
                <span>Move camera</span>
              </div>
              <div class="flex items-center gap-2">
                <kbd class="kbd kbd-xs bg-base-300">Scroll</kbd>
                <span>Zoom in/out</span>
              </div>
              <div class="flex items-center gap-2">
                <kbd class="kbd kbd-xs bg-base-300">Space</kbd>
                <span>Place origin (0,0) at top-left</span>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Geometry Panel -->
    <div id="geometry-panel" class="fixed top-4 left-4 w-80 max-h-[calc(100vh-2rem)] bg-base-100/95 backdrop-blur-md border border-base-300 rounded-xl shadow-2xl z-50 overflow-hidden animate-fade-in" style="display: none;">
      <!-- Header -->
      <div class="bg-base-200/50 border-b border-base-300 p-4">
        <h2 class="text-lg font-bold text-secondary flex items-center gap-2">
          <span class="text-success">🎨</span>
          Geometry Tools
        </h2>
      </div>
      
      <!-- Scrollable Content -->
      <div class="max-h-[calc(100vh-8rem)] overflow-y-auto custom-scrollbar p-2">
        
        <!-- Drawing Modes -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-success flex items-center gap-2">
              <span class="text-xs">▸</span>
              Drawing Modes
            </h3>
            <div class="grid grid-cols-2 gap-2">
              <button id="geometry-mode-none" class="btn btn-xs btn-outline">None</button>
              <button id="geometry-mode-point" class="btn btn-xs btn-outline">Point</button>
              <button id="geometry-mode-line" class="btn btn-xs btn-outline">Line</button>
              <button id="geometry-mode-circle" class="btn btn-xs btn-outline">Circle</button>
              <button id="geometry-mode-rectangle" class="btn btn-xs btn-outline">Rectangle</button>
              <button id="geometry-mode-diamond" class="btn btn-xs btn-outline">Diamond</button>
            </div>
          </div>
        </div>

        <!-- Current State -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-primary flex items-center gap-2">
              <span class="text-xs">▸</span>
              Current State
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Mode:</span>
                <span id="geometry-current-mode" class="font-bold font-mono text-success">none</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Objects:</span>
                <span id="geometry-objects-count" class="font-bold font-mono text-primary">0</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Selected:</span>
                <span id="geometry-selected-count" class="font-bold font-mono text-info">0</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Layer Visibility -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-warning flex items-center gap-2">
              <span class="text-xs">▸</span>
              Layer Visibility
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Grid:</span>
                <button id="geometry-toggle-grid" class="btn btn-xs">
                  <span id="geometry-layer-grid" class="font-bold font-mono">ON</span>
                </button>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Geometry:</span>
                <button id="geometry-toggle-geometry" class="btn btn-xs">
                  <span id="geometry-layer-geometry" class="font-bold font-mono">ON</span>
                </button>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Raycast:</span>
                <button id="geometry-toggle-raycast" class="btn btn-xs">
                  <span id="geometry-layer-raycast" class="font-bold font-mono">ON</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Drawing Settings -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-accent flex items-center gap-2">
              <span class="text-xs">▸</span>
              Drawing Settings
            </h3>
            <div class="space-y-2">
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Color:</span>
                <span id="geometry-default-color" class="font-bold font-mono text-accent">#0066cc</span>
              </div>
              <div class="flex justify-between items-center text-xs">
                <span class="text-base-content/70">Stroke Width:</span>
                <span id="geometry-default-stroke-width" class="font-bold font-mono text-accent">2</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="card bg-base-200/30 shadow-sm mb-3">
          <div class="card-body p-3">
            <h3 class="card-title text-sm text-error flex items-center gap-2">
              <span class="text-xs">▸</span>
              Actions
            </h3>
            <button id="geometry-clear-all" class="btn btn-sm btn-error w-full">
              Clear All Objects
            </button>
          </div>
        </div>

        <!-- Instructions -->
        <div class="alert alert-success bg-success/10 border-success/20">
          <div class="w-full">
            <h4 class="font-bold text-sm text-success mb-2 flex items-center gap-2">
              <span>✨</span>
              Instructions
            </h4>
            <div class="space-y-1 text-xs text-base-content/80">
              <div>• Select a drawing mode above</div>
              <div>• Click on canvas to draw</div>
              <div>• Use layer toggles to show/hide</div>
              <div>• Check Store Panel for debug info</div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Object Edit Panel -->
    <div id="object-edit-panel" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 bg-base-100/95 backdrop-blur-md border border-base-300 rounded-xl shadow-2xl z-60 overflow-hidden animate-fade-in" style="display: none;">
      <!-- Header -->
      <div class="bg-base-200/50 border-b border-base-300 p-4 flex justify-between items-center">
        <h2 class="text-lg font-bold text-accent flex items-center gap-2">
          <span class="text-warning">✏️</span>
          Edit Object
        </h2>
        <button id="edit-panel-close" class="btn btn-sm btn-ghost btn-circle">
          <span class="text-lg">✕</span>
        </button>
      </div>
      
      <!-- Content -->
      <div class="p-4 space-y-4">
        <div class="alert alert-info bg-info/10 border-info/20">
          <div class="text-sm">
            <div class="font-bold mb-1">Object ID:</div>
            <div id="edit-object-id" class="font-mono text-xs">-</div>
          </div>
        </div>

        <!-- Object Properties -->
        <div class="space-y-3">
          <div>
            <label class="label">
              <span class="label-text">Anchor X:</span>
            </label>
            <input id="edit-anchor-x" type="number" step="0.5" class="input input-bordered w-full" />
          </div>
          
          <div>
            <label class="label">
              <span class="label-text">Anchor Y:</span>
            </label>
            <input id="edit-anchor-y" type="number" step="0.5" class="input input-bordered w-full" />
          </div>
          
          <div>
            <label class="label">
              <span class="label-text">Width:</span>
            </label>
            <input id="edit-width" type="number" step="1" min="2" class="input input-bordered w-full" />
          </div>
          
          <div>
            <label class="label">
              <span class="label-text">Stroke Width:</span>
            </label>
            <input id="edit-stroke-width" type="number" step="0.5" min="0.5" class="input input-bordered w-full" />
          </div>
          
          <div>
            <label class="label">
              <span class="label-text">Visible:</span>
            </label>
            <input id="edit-visible" type="checkbox" class="toggle toggle-primary" />
          </div>
        </div>

        <!-- Actions -->
        <div class="flex gap-2 pt-4">
          <button id="edit-panel-apply" class="btn btn-primary flex-1">Apply Changes</button>
          <button id="edit-panel-cancel" class="btn btn-outline flex-1">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Layer Toggle Bar (Bottom Center) -->
    <div id="layer-toggle-bar" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-base-100/95 backdrop-blur-md border border-base-300 rounded-full shadow-lg z-50 px-4 py-2">
      <div class="flex items-center gap-3">
        <span class="text-sm font-semibold text-accent">Layers</span>
        <div class="divider divider-horizontal mx-0"></div>
        <button id="toggle-layer-grid" class="btn btn-sm btn-success rounded-full">
          <span class="button-text">Grid</span>
        </button>
        <button id="toggle-layer-geometry" class="btn btn-sm btn-secondary rounded-full">
          <span class="button-text">Geometry</span>
        </button>
        <button id="toggle-layer-raycast" class="btn btn-sm btn-warning rounded-full">
          <span class="button-text">Raycast</span>
        </button>
      </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>